package DesignGrade;

import javax.swing.*;
import java.awt.*;
import javax.swing.border.EmptyBorder;

public class SearchPanel extends JPanel {
    public SearchPanel() {
        setBackground(new Color(255, 220, 220));
        setLayout(new BoxLayout(this, BoxLayout.Y_AXIS));

        JLabel searchLabel = new JLabel("검색", SwingConstants.CENTER);
        searchLabel.setOpaque(true);
        searchLabel.setBackground(new Color(210, 240, 250));
        searchLabel.setAlignmentX(Component.CENTER_ALIGNMENT);
        searchLabel.setMaximumSize(new Dimension(Integer.MAX_VALUE, 40));
        add(searchLabel);
        add(Box.createVerticalStrut(10));

        JPanel searchModePanel = new JPanel(new GridLayout(1,2,10,10));
        searchModePanel.setBackground(new Color(255, 220, 220));
        JButton nameBtn = new JButton("이름");
        nameBtn.setBackground(new Color(210, 240, 250));
        searchModePanel.add(nameBtn);
        JButton meanBtn = new JButton("평균");
        meanBtn.setBackground(new Color(210, 240, 250));
        searchModePanel.add(meanBtn);
        add(searchModePanel);

        // 카드 영역
        JPanel searchCard = new JPanel(new CardLayout());
        searchCard.setBackground(new Color(255, 220, 220));
        searchCard.setBorder(new EmptyBorder(30, 20, 30, 20));
        add(searchCard);

        // 이름 검색 카드
        JPanel searchNameBox = new JPanel();
        searchNameBox.setBackground(new Color(255, 220, 220));
        searchNameBox.setLayout(new BoxLayout(searchNameBox, BoxLayout.Y_AXIS));
        
        JPanel nameGrid = new JPanel(new GridLayout(1,3,10,10));
        nameGrid.setBackground(new Color(255, 220, 220));
        
        JLabel nameLabel = new JLabel("이름", SwingConstants.CENTER);
        nameGrid.add(nameLabel);
        
        JTextField nameField = new JTextField();
        nameGrid.add(nameField);
        
        JButton nameButton = new JButton("확인");
        nameGrid.add(nameButton);    
        searchNameBox.add(nameGrid);
        
        //출력창
        JTextArea outPutArea = new JTextArea(4, 25);
        outPutArea.setEditable(false);
        searchNameBox.add(new JScrollPane(outPutArea)); 
        
        // 이름검색 동작
        nameButton.addActionListener(e -> {
            String searchName = nameField.getText().trim();
            boolean found = false;
            StringBuilder sb = new StringBuilder();
            for (Student s : StudentManager.students) {
                if (s.name.equals(searchName)) {
                    sb.append("이름: ").append(s.name)
                      .append("\n국어: ").append(s.korean)
                      .append("\n영어: ").append(s.english)
                      .append("\n수학: ").append(s.math);
                    found = true;
                    break;
                }
            }
            if (!found) {
                sb.append("검색 결과가 없습니다.");
            }
            outPutField1.setText(sb.toString());
        });

        // 평균 검색 카드
        JPanel searchMeanBox = new JPanel();
        searchMeanBox.setBackground(new Color(255, 220, 220));
        searchMeanBox.setLayout(new BoxLayout(searchMeanBox, BoxLayout.Y_AXIS));
        JPanel meanGrid = new JPanel(new GridLayout(1,3,10,10));
        meanGrid.setBackground(new Color(255, 220, 220));
        JLabel meanLabel = new JLabel("평균", SwingConstants.CENTER);
        meanGrid.add(meanLabel);
        JTextField meanField = new JTextField();
        meanGrid.add(meanField);
        JButton meanButton = new JButton("확인");
        meanGrid.add(meanButton);
        searchMeanBox.add(meanGrid);
        JTextField outPutField2 = new JTextField();
        outPutField2.setEditable(false);
        searchMeanBox.add(outPutField2);

        searchCard.add(searchNameBox, "NAME");
        searchCard.add(searchMeanBox, "MEAN");

        CardLayout searchcardLayout = (CardLayout) searchCard.getLayout();
        nameBtn.addActionListener(e -> searchcardLayout.show(searchCard, "NAME"));
        meanBtn.addActionListener(e -> searchcardLayout.show(searchCard, "MEAN"));
    }
}
